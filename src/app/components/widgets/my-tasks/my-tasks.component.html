<div class="tasks-container">
    <h3>My Tasks</h3>
    <ng-container *ngIf="selectedTask === null; else taskDetails">
      <ul>
        <li *ngFor="let task of tasks">
          <span (click)="onTaskClick(task)">{{ task.title }}</span>
          <input type="checkbox" [checked]="task.completed" (change)="toggleTaskCompletion(task)">
          <button (click)="deleteTask(task); $event.stopPropagation();">Delete</button>
          <button (click)="editTask(task); $event.stopPropagation();">Edit</button>
        </li>
      </ul>
      <div class="add-task">
        <input [(ngModel)]="newTask.title" placeholder="New Task Title">
        <input [(ngModel)]="newTask.date" placeholder="New Task Date" type="date">
        <button (click)="addTask()">Add Task</button>
      </div>
    </ng-container>
    <ng-template #taskDetails>
      <div class="task-details">
        <h4>Task Details</h4>
        <p>Title: {{ selectedTask?.title }}</p>
        <p>Date: {{ selectedTask?.date }}</p>
        <p>Completed: {{ selectedTask?.completed ? 'Yes' : 'No' }}</p>
        <button (click)="backToTasks()">Back to Tasks</button>
        <button *ngIf="!isEditing" (click)="editTask(selectedTask!)">Edit Task</button> <!-- Use type assertion -->
        <div *ngIf="isEditing">
          <input *ngIf="selectedTask" [(ngModel)]="selectedTask.title" placeholder="Task Title">
          <input *ngIf="selectedTask" [(ngModel)]="selectedTask.date" placeholder="Task Date" type="date">
          <button (click)="saveTask()">Save</button>
          <button (click)="cancelEdit()">Cancel</button>
        </div>
      </div>
    </ng-template>
  </div>